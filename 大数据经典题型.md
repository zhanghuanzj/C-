## 十道海量数据处理面试题 ##

### 1、海量日志数据，提取出某日访问百度次数最多的那个IP。 ###
　　**方案1： **IP的数目还是有限的，最多2^32个，所以可以考虑使用hash将ip直接存入内存，然后进行统计。
　　**方案2： **同样可以采用映射的方法，比如模1000，把整个大文件映射为1000个小文件，再找出每个小文中出现频率最大的IP（可以采用hash_map进行频率统计，然后再找出频率最大的几个）及相应的频率。然后再在这1000个最大的IP中，找出那个频率最大的IP，即为所求。


### 2、搜索引擎会通过日志文件把用户每次检索使用的所有检索串都记录下来，每个查询串的长度为1-255字节。请你统计最热门的10个查询串，要求使用的内存不能超过1G。 ###
　　由于重复度比较高，300万*255字节 = 765M，不会超过1G，因此可以用Hash_Map的思路。通过哈希函数将字符串映射到Hash空间中，哈希模型的Key值为字符串，value值为字符串的出现次数count。之后维护一个k = 10的小根堆，这样能保证在logK的时间内查找和删除元素，因此总体的时间复杂度是O(n) + O(nlogk)

### 3、有一个1G大小的一个文件，里面每一行是一个词，词的大小不超过16字节，内存限制大小是1M。返回频数最高的100个词。 ###

　　由于内存有限，先对单词进行hash映射到多个小于1M的文件中，对每个小文件，统计每个文件中出现的词以及相应的频率（可以采用trie树/hash_map等），并取出出现频率最大的100个词（可以用含100个结点的最小堆），并把100个词及相应的频率存入文件，这样又得到了5000个文件。下一步就是把这5000个文件进行归并（类似与归并排序）的过程了。

### 4、有10个文件，每个文件1G，每个文件的每一行存放的都是用户的query，每个文件的query都可能重复。要求你按照query的频度排序。 ###
　　**方案1： **顺序读取10个文件，按照hash(query)%10的结果将query写入到另外10个文件（记为）中。这样新生成的文件每个的大小大约也1G（假设hash函数是随机的）。 找一台内存在2G左右的机器，依次对用hash_map(query, query_count)来统计每个query出现的次数。利用快速/堆/归并排序按照出现次数进行排序。将排序好的query和对应的query_cout输出到文件中。这样得到了10个排好序的文件（记为）。
　　对这10个文件进行归并排序（内排序与外排序相结合）。
　　**方案2： **一般query的总量是有限的，只是重复的次数比较多而已，可能对于所有的query，一次性就可以加入到内存了。这样，我们就可以采用trie树/hash_map等直接来统计每个query出现的次数，然后按出现次数做快速/堆/归并排序就可以了。
　　**方案3：** 与方案1类似，但在做完hash，分成多个文件后，可以交给多个文件来处理，采用分布式的架构来处理（比如MapReduce），最后再进行合并。

### 5、给定a、b两个文件，各存放50亿个url，每个url各占64字节，内存限制是4G，让你找出a、b文件共同的url？ ###

　　**方案1：**各自分别对每个url求取hash(url)%1000，然后根据所取得的值将url分别存储到1000个小文件，然后我们只要求出1000对小文件中相同的url即可。利用hash_set即可。
　　**方案2：**如果允许有一定的错误率，可以使用Bloom filter，4G内存大概可以表示340亿bit。将其中一个文件中的url使用Bloom filter映射为这340亿bit，然后挨个读取另外一个文件的url，检查是否与Bloom filter，如果是，那么该url应该是共同的url（注意会有一定的错误率）。

### 6、在2.5亿个整数中找出不重复的整数，注，内存不足以容纳这2.5亿个整数。 ###
　　**方案1：**采用2-Bitmap（每个数分配2bit，00表示不存在，01表示出现一次，10表示多次，11无意义）进行。 
　　**方案2：**hash映射到小文件再从中找到不重复的数。 

### 7、腾讯面试题：给40亿个不重复的unsigned int的整数，没排过序的，然后再给一个数，如何快速判断这个数是否在那40亿个数当中？ ###
　　**方案1：**Bit置位法
　　**方案2：**将这40亿个数分成两类: 1.最高位为0 2.最高位为1 并将这两类分别写入到两个文件中；与要查找的数的最高位比较并接着进入相应的文件再查找再然后把这个文件为又分成两类: 1.次最高位为0 2.次最高位为1....... 以此类推，就可以找到了,而且时间复杂度为O(logn)。
###8、怎么在海量数据中找出重复次数最多的一个？ ###
　　 **方案1：**先做hash，然后求模映射为小文件，求出每个小文件中重复次数最多的一个，并记录重复次数。然后找出上一步求出的数据中重复次数最多的一个就是所求。

###9、上千万或上亿数据（有重复），统计其中出现次数最多的前N个数据。###
　　**方案1：**上千万或上亿的数据，现在的机器的内存应该能存下。所以考虑采用hash_map/搜索二叉树/红黑树等来进行统计次数。然后就是取出前N个出现次数最多的数据了，可以用堆机制完成。

### 10、一个文本文件，大约有一万行，每行一个词，要求统计出其中最频繁出现的前10个词，请给出思想，给出时间复杂度分析。 ###
　　这题是考虑时间效率。用trie树统计每个词出现的次数，时间复杂度是O(n*le)（le表示单词的平准长度）。然后是找出出现最频繁的前10个词，可以用堆来实现，前面的题中已经讲到了，时间复杂度是O(n*lg10)。所以总的时间复杂度，是O(n*le)与O(n*lg10)中较大的哪一个。

